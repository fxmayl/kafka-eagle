
CREATE TABLE IF NOT EXISTS `ke_p_role` (`id` bigint(20) NOT NULL AUTO_INCREMENT,`name` varchar(64) CHARACTER SET utf8 NOT NULL COMMENT 'role name',`seq` tinyint(4) NOT NULL COMMENT 'rank',`description` varchar(128) CHARACTER SET utf8 NOT NULL COMMENT 'role describe',PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4;
INSERT INTO `ke_p_role` VALUES ('1', 'Administrator', '1', 'Have all permissions'), ('2', 'Devs', '2', 'Own add or delete'), ('3', 'Tourist', '3', 'Only viewer');
CREATE TABLE IF NOT EXISTS `ke_resources` (`resource_id` bigint(20) NOT NULL AUTO_INCREMENT,`name` varchar(255) CHARACTER SET utf8 NOT NULL COMMENT 'resource name',`url` varchar(255) NOT NULL,`parent_id` int(11) NOT NULL,PRIMARY KEY (`resource_id`)) ENGINE=InnoDB AUTO_INCREMENT=17 DEFAULT CHARSET=utf8mb4;
INSERT INTO `ke_resources` VALUES ('1', 'System', '/system', '-1'), ('2', 'User', '/system/user', '1'), ('3', 'Role', '/system/role', '1'), ('4', 'Resource', '/system/resource', '1'), ('5', 'Notice', '/system/notice', '1'), ('6', 'Topic', '/topic', '-1'), ('7', 'Message', '/topic/message', '6'), ('8', 'Create', '/topic/create', '6'), ('9', 'Alarm', '/alarm', '-1'), ('10', 'Add', '/alarm/add', '9'), ('11', 'Modify', '/alarm/modify', '9'), ('12', 'Cluster', '/cluster', '-1'), ('13', 'ZkCli', '/cluster/zkcli', '12'), ('14', 'UserDelete', '/system/user/delete', '1'), ('15', 'UserModify', '/system/user/modify', '1'), ('16', 'Mock', '/topic/mock', '6'), ('18', 'Create', '/alarm/create', '9'), ('19', 'History', '/alarm/history', '9'), ('20', 'Manager', '/topic/manager', '6'), ('21', 'PasswdReset', '/system/user/reset', '1'), ('22', 'Config', '/alarm/config', '9'), ('23', 'List', '/alarm/list', '9'), ('24', 'Hub', '/topic/hub', '6');
DROP TABLE IF EXISTS `ke_consumer_group_summary`; create table `ke_consumer_group_summary` (`cluster` varchar(64) NOT NULL,`group` varchar(128) NOT NULL,`topic_number` varchar(128) NOT NULL,`coordinator`varchar(128) DEFAULT NULL,`active_topic` int(11) DEFAULT NULL,`active_thread_total` int(11) DEFAULT NULL, PRIMARY KEY (`cluster`,`group`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_alarm_crontab`; create table `ke_alarm_crontab`(`id` bigint(20) NOT NULL ,`type` varchar(64) NOT NULL,`crontab` varchar(32) DEFAULT NULL, `is_enable` varchar(2) DEFAULT 'Y', `DROPd` varchar(32) DEFAULT NULL,`modify` varchar(32) DEFAULT NULL, PRIMARY KEY (`id`,`type`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_consumer_bscreen`;create table `ke_consumer_bscreen`(`cluster` varchar(64) DEFAULT NULL,`group` varchar(128) DEFAULT NULL,`topic` varchar(64) DEFAULT NULL,`logsize` bigint(20) DEFAULT NULL,`difflogsize` bigint(20) DEFAULT NULL,`offsets` bigint(20) DEFAULT NULL,`diffoffsets` bigint(20) DEFAULT NULL,`lag` bigint(20) DEFAULT NULL,`timespan` bigint(20) DEFAULT NULL,`tm` varchar(16) DEFAULT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_users`; create table `ke_users`(`id` bigint(20) NOT NULL AUTO_INCREMENT,`rtxno` int(11) NOT NULL,`username` varchar(64) NOT NULL,`password` varchar(128) NOT NULL,`email` varchar(64) NOT NULL,`realname` varchar(128) NOT NULL,PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_metrics`; create table `ke_metrics`(`cluster` varchar(64) DEFAULT NULL,`broker` text DEFAULT NULL,`type` varchar(32) DEFAULT NULL,`key` varchar(64) DEFAULT NULL,`value` varchar(128) DEFAULT NULL,`timespan` bigint(20) DEFAULT NULL,`tm` varchar(16) DEFAULT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_alarm_clusters`;create table `ke_alarm_clusters` (`id` bigint(20) NOT NULL AUTO_INCREMENT,`type` varchar(32) DEFAULT NULL,`cluster` varchar(64) DEFAULT NULL,`server` text DEFAULT NULL,`alarm_group` varchar(128) DEFAULT NULL,`alarm_times` int(11),`alarm_max_times` int(11) , `alarm_level` varchar(4),`is_normal` varchar(2) DEFAULT 'Y',`is_enable` varchar(2) DEFAULT 'Y', `DROPd` varchar(32) DEFAULT NULL,`modify` varchar(32) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_alarm_consumer`; create table `ke_alarm_consumer`(`id` bigint(20) NOT NULL AUTO_INCREMENT,`cluster` varchar(64) DEFAULT NULL,`group` varchar(128) DEFAULT NULL,`topic` varchar(128) DEFAULT NULL,`lag` bigint(20) DEFAULT NULL,`alarm_group` varchar(128) DEFAULT NULL,`alarm_times` int(11),`alarm_max_times` int(11) , `alarm_level` varchar(4),`is_normal` varchar(2) DEFAULT 'Y', `is_enable` varchar(2) DEFAULT 'Y', `DROPd` varchar(32) DEFAULT NULL,`modify` varchar(32) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
INSERT INTO `ke_role_resource` VALUES ('1', '1', '1'), ('2', '1', '2'), ('3', '1', '3'), ('4', '1', '4'), ('5', '1', '5'), ('6', '1', '7'), ('7', '1', '8'), ('8', '1', '10'), ('9', '1', '11'), ('10', '1', '13'), ('11', '2', '7'), ('12', '2', '8'), ('13', '2', '13'), ('14', '2', '10'), ('15', '2', '11'), ('16', '1', '14'), ('17', '1', '15'), ('18', '1', '16'), ('19', '1', '18'), ('20', '1', '19'), ('21', '1', '20'), ('22', '1', '21'), ('23', '1', '22'), ('24', '1', '23'), ('25', '1', '24');
ALTER TABLE `ke_logsize` ADD INDEX `idx_tm_cluster_diffval` (`tm`, `cluster`, `diffval`);
DROP TABLE IF EXISTS `ke_connect_config`; create table `ke_connect_config`(`id` bigint(20) NOT NULL AUTO_INCREMENT,`cluster` varchar(64),`connect_uri` varchar(128),`version` varchar(32),`alive` varchar(16),`DROPd` varchar(32) DEFAULT NULL,`modify` varchar(32) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_sql_history`; create table `ke_sql_history`(`id` bigint(20) NOT NULL AUTO_INCREMENT, `cluster` varchar(64) DEFAULT NULL,`username` varchar(64) DEFAULT NULL,`host` varchar(128) DEFAULT NULL,`ksql` text DEFAULT NULL,`status` varchar(16) DEFAULT NULL,`spend_time` bigint(20) DEFAULT NULL,`DROPd` varchar(32) DEFAULT NULL,`tm` varchar(16) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
ALTER TABLE `ke_consumer_bscreen` ADD INDEX `idx_timespan` (`timespan`);
DROP TABLE IF EXISTS `ke_metrics_offline`; create table `ke_metrics_offline`(`cluster` varchar(64) NOT NULL,`key` varchar(128) NOT NULL,`one` varchar(128) DEFAULT NULL,`mean` varchar(128) DEFAULT NULL,`five` varchar(128) DEFAULT NULL,`fifteen` varchar(128) DEFAULT NULL, PRIMARY KEY (`cluster`,`key`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_consumer_group`;create table `ke_consumer_group`(`cluster` varchar(64) NOT NULL,`group` varchar(128) NOT NULL,`topic` varchar(128) NOT NULL,`status` int(11) DEFAULT NULL, PRIMARY KEY (`cluster`,`group`,`topic`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_alarm_config`;create table `ke_alarm_config`(`cluster` varchar(64) NOT NULL,`alarm_group` varchar(128) NOT NULL,`alarm_type` varchar(16) DEFAULT NULL,`alarm_url` text DEFAULT NULL,`http_method` varchar(16) DEFAULT NULL,`alarm_address` text DEFAULT NULL,`DROPd` varchar(32) DEFAULT NULL,`modify` varchar(32) DEFAULT NULL, PRIMARY KEY (`cluster`,`alarm_group`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
ALTER TABLE `ke_logsize` ADD INDEX `idx_timespan` (`timespan`);
ALTER TABLE `ke_logsize` ADD INDEX `idx_tm_topic` (`tm`, `topic`);
INSERT INTO `ke_users` VALUES ('1', '1000', 'admin', '123456', 'admin@email.com', 'Administrator');
ALTER TABLE `ke_consumer_bscreen` ADD INDEX `idx_tm_cluster_diffoffsets` (`tm`, `cluster`, `diffoffsets`);
DROP TABLE IF EXISTS `ke_topic_rank`;create table `ke_topic_rank`(`cluster` varchar(64) NOT NULL,`topic` varchar(64) NOT NULL,`tkey` varchar(64) NOT NULL,`tvalue` bigint(20) DEFAULT NULL,PRIMARY KEY (`cluster`,`topic`,`tkey`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_user_role`;create table `ke_user_role`(`id` bigint(20) NOT NULL AUTO_INCREMENT,`user_id` int(11) NOT NULL,`role_id` tinyint(4) NOT NULL,PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4;
DROP TABLE IF EXISTS `ke_role_resource`; create table `ke_role_resource`(`id` bigint(20) NOT NULL AUTO_INCREMENT,`role_id` int(11) NOT NULL,`resource_id` int(11) NOT NULL,PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=19 DEFAULT CHARSET=utf8mb4;
INSERT INTO `ke_user_role` VALUES ('1', '1', '1');
DROP TABLE IF EXISTS `ke_logsize`; create table `ke_logsize`(`cluster` varchar(64) DEFAULT NULL,`topic` varchar(64) DEFAULT NULL,`logsize` bigint(20) DEFAULT NULL,`diffval` bigint(20) DEFAULT NULL,`timespan` bigint(20) DEFAULT NULL,`tm` varchar(16) DEFAULT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
